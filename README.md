# 你好， 世界！😄
## 十九届智能视觉备战
### 2024/4/10
昨晚偶然间又看了木哥的备战“日记”， 感受很多，颇受启发。感受到有许多值得咱们学习的地方：
- 每个一段时间就反思总结， 回顾近段时间做了什么，明晰下一阶段应该做什么
- 提高效率，有时不要太意气用事，多点理性
- 学习永无止境，热爱就是动力，学习英语即使如此，不必感到烦恼，把它权当你技术学习上的工具，每天坚持
  当然还有许多值得学习借鉴的地方，哈哈，就这么简单写点吧，以后这可以作为我们交流、分享讨论的地方，鼓励大家也来多写写心得体会，bye

### 2024/4/11
目前阶段现状：
1. PCB焊接未搞定(如果板子没问题，尽量在下周结束之前完成-21号)
2. 卡片数据集还有许多类别未拍，可以每天有空就拍一类，轮流拍，完成每日任务任务，不要过于依赖学弟， 导致拍的效率很低？（江老师说得对，压榨学弟不如压榨自己）
3. 车硬件总体调试（尽快要完成了，不能再拖， 周末之前完成）
4. 元素识别稳定性加强，以及在元素部分赛道的运动控制还没完成
5. OpenArt 目标检测以及串口传输数据（如何确保信息的准确性，考虑滤掉一些信息）

故下周主要任务就是4，5，争取让车车先跑起来，模型的准确性先不提
这周拍完数据集，打完标签开始炼丹，不能再拖了


### 2024/4/11
今日工作，像机器人一样拍照，莫得感情，明天继续，拍完四类，难受。
### 2024/4/14
受到木哥指点，认真检查驱动板的焊接，发现普遍存在的虚焊问题，焊了一天板子成功修好以前失败的三块驱动板，焊接技术进阶
数据集拍完，驱动板完成。

### 2024/4/16
下阶段任务 完成二代机械结构，框架加宽，机械臂优化，这次依然使用3d打印，后期优化替换
           探索炼丹技巧
           定下目标检测及分类识别的思路，测试openart可以运行两个模型，但可能是框选不标准导致识别率极低。目标检测重拍，如何拍？
           争取下周之前焊好主板，将车车以前学长的硬件结构替换为自己的，完成硬件任务
           最最最最重要！！！！！！背单词，考四级！

### 2024/5/1
   五一九天假？直接完赛？
   目前阶段现状：主板焊完测试完成，硬件结构以全部替换，机械结构完成，硬件任务完成
                炼丹一直是废丹，继续探索炼丹技巧
                控制代码不断完善，十字运行状态良好，下一步与openart结合进行控制，捡卡片的思路？
                openart分类识别时如何准确的框选出图片？
                调参这种事现阶段还是不要浪费太多时间，还没到死磕的时候目前就是调差不多能用就行吧
       九天的假期相比于之前零碎时间效率还是很高的，这段时间争取完成大部分任务，这段时间也是通宵了两天，（江老师是真的狠人，
     动不动就要调一晚上，相比江老师做的任务量，非常的自愧不如，比起江老师感觉自己有点摆，无比惭愧。注：后面打的都是身体战，如果现在不好好休息，
     后面是绝对撑不住的，江老师保重身体啊！）希望可以利用这次假期完赛吧。（献祭一个江老师）


### 2024/5/2

### 2024/5/3
现在是早上五点，差不多熬了一晚上，现在倒是挺精神的😂，张老师说的没错：后面打的都是身体战！回过头来看看这两三天的调车时光，确实，这就是差距的，一个代码写出来总会遇到各种bug,总是要调试很多次取找出bug所在，每次烧录完程序自信满满地以为这次绝对能行，可最后往往以打脸结束。代码框架先在脑海中初具雏形，到反复调试，找bug, 能运行，考量优化，其实我觉得有很大一部分时间浪费在找bug上。有时觉得自己效率太低，调了半天车，没什么进展，往往内耗自己的情绪；有时做一个事情，半路里觉得“有必要”去先完成另外一件事情，另一件事情做了回儿，觉得另另一件事应该先完成，哈哈，这就是顾此失彼啊，没有把握重点。每天先明晰第一优先级要做的是什么，如果被其他打断，有必要去做那么不是很有必要的事吗？往往是做这做那，就忘了根本的目的。希望以后引以为戒

前段时间张老师也是花了很多时间完成了驱动板和主板的焊接，也算是取得了突破性进展，我要称之为“大交汉武帝”，这几天调车哥们也是一起肝啊，也是辛苦了张老师咧
五一假期已过半，还有几天时光，分析一下下一阶段的工作：
- 练得一手好单，张老师也是练了很多丹了，但效果不是那么令人满意，下一阶段和张老师探讨一下，请教学长
- 该上openart了，先挑卡片矫正，目标检测若效果还行可以加上目标检测看看矫正效果
- 组织一下几个摄像头与核心板的通讯，分析一下总体通讯（小车控制）逻辑
- 数字字母的分类数据集应该也可以拍一拍了，这个效果应该很好
- 可以先拿个MCX Vision玩玩，了解以下怎么使用？


### 2024/5/6
 ！！！！丹成！！！！！
 也是和兄弟们又通宵一天，这次也是有两个学弟的陪伴，学弟的效率也是很高的，一晚上就打完了几千张照片的标签，不知道这算不算压迫学弟😝。
 也是在今天早上终于成神丹，过程也是有点难崩，我可能已经错过了好几次成神丹的机会了，前面无数次效果令人不满意的废丹其实是因为验证错误的问题，
 他们很有可能是神丹的😭，具体原因是逐飞给的分类识别的脚本 img.copy(r.rect()) 的使用错误，它并没有copy出感兴趣区域，而是使用的整个图像，
 这也是在使用目标检测后框出不理想框反而判断更精准而发现，因而出现了种种我们认为不理想的丹，将它改为 img1 = img.copy(1,1, r.rect())  
 就可以了，从中的感悟也是颇深😊。
  放假的这段时间虽然没有完赛但效率也是非常高的，也是和江老师通宵了四五天，现在生物钟都混乱了

- 完成炼丹任务
- 目标检测训练完成，90度分类目标检测良好，虽然可能框的不太准确，但好在丹硬，识别率还是非常高的，130度目标检测效果不太好，会出现近处标不出的问题，后面可能需要重练
- 数字字母的分类识别虽然只练了150多轮，准确率也是高的离谱
- 今天还发现调整openart的亮度也就是曝光时间会影响帧率，在降低曝光时间后帧率提高显著，所以补光灯变成了非常有必要了
- 目前来说任务就只剩和openart结合进行控制了，至于其他的暂且把他们归为优化项（换五分类？换碳板？），目前保证先完赛吧
- 自从调车后也是有点厌学，四级已经一个月没看了😭😭😭，感觉需要找点时间学学四级😔😔

### 2024/5/22
近两周进度推进缓慢，有些停滞
目前mcx已能用于目标检测，部署到实际的行车环境，今晚简单调了下，还有些小问题。
- 弯道可能识别不到卡片，可能是参考点的选择不太合理或者距离计算公式得优化
- 有时会误识别，导致转错方向，why?
- 仓舵机仍是一大问题，时不时还会发癫痫，今晚换了线，明天再试试会不会有问题
- bug:有时转向后会倒着走？
- 主板电源电路的问题，现在先放放？？？？？

下一阶段（6/1之前）：
- 把上面提到的问题，解决
- 把分类加上去，实现与仓配合
- 十字环岛逻辑控制完成
- 放置卡片

加油啊xdm，完成上面的内容也基本完赛了，**提高效率与执行力，不要再拖了**
<u>时间过得很快!!!</u>
<u>时间过得很快!!!</u>
<u>时间过得很快!!!</u>
早日完赛！⛽

### 2024/6/5
!!!!!完赛!!!!!
计划的完赛日期一拖再拖，终于还是完赛了（虽然坡道和障碍还没写😁），完赛情况比预期要好，虽然存在一些问题，但还是比较丝滑。
- 仓抖的问题解决，和预期的一样是因为杜邦线接触不良，也可能是主板硬件的毛病（当时少几类电阻就直接拿差不多阻值的代替了，有点随便😝）在换了线和焊了一块新主板之后就稳得很
- mcx目标检测的问题解决，之前的种种问题完全是因为屏幕太小没有显示整张图像，造成了很多假想的问题，换了块大屏幕之后问题就自然消失了，所以说在调车的时候最忌讳盲调，一定要有人机交互的端口，屏幕或者无线串口。
- openart的卡死问题解决，这个问题也是困扰了我很多天，每天都非常煎熬，以为是内存的问题，因为毕竟运行了三个模型，为此还爆金币又买了一个art(当时舵机也是，一开始以为是坏了，又买了两个舵机，太贵了😭，但是无所谓了，有备着的总是好的，就算是给学弟的积累财富吧，毕竟我们也是传承了木哥当年的车车和大部分元件，希望能传承下去吧），也是今天晚上试车时偶然发现，我们的openart程序中的roi会超出边界，具体原因是因为目标检测框出来的roi会整体偏左，所以在使用roi时进行了手动调整，比如x1 = int((x1-0,1)*img.width())，这时候问题就来了，假如手动调整过后x1,小于零，那么roi显然已经超出了图像范围，所以可以对此加以筛选，if x1<0:  x1=0，就可解决。
- 目前的最急需解决的问题就是放卡片和捡卡片不能一次完成，主要问题是矫正的位置不精确和电磁铁的问题，当然有可能是卡片本身的问题，当时粗制烂造的卡片也是深受其害


-所以下阶段的任务-

- 把避障和坡道的代码写完，坡道可以选择直接不走或加辅助轮冲过去
- 解决放卡片和捡卡片问题，试一试换一个电磁铁，优化一下机械臂路径，优化卡片矫正的算法
- 试车调车，每天都跑一跑车真的有用，每次跑几乎都能发现问题，还有一下隐藏的不容易出现的问题，边试边调一直是我们调车的最佳方案




### 2024/6/5
从前几天开始已经陆续完赛了，昨天又熬了一夜，解决了很多的bug,对控制进行了优化，运行起来丝滑了许多，目前识别和分类的正确率也得到保证了，到目前为止可以说已经基本完赛，若不提完赛用时的话运行起来还算比较稳定，有一定鲁棒性。虽然比预期的完赛日期晚了几天，但也总算完赛了，先庆祝一下🥳🎉

回归之前的问题，这里简单做下总结：
1.卡片的距离计算公式似乎不用太精确，以前以为mcx的前瞻因该很远，故需判断卡片的距离，但目前我们的mcx的前瞻调的较低，画面中只要有卡片，说明就已经不远了，所以这里简单的用像素点之间的距离来代表两者之间的距离，效果也是可以的，所以啊空想不如实际去动手试一下
2.仓舵机的问题之前一直萦绕了我们很久，也换过舵机，买过新舵机，仍然不行，最后发现是**杜邦线接口松动**的问题，只能说"踏破铁鞋无觅处，得来全不费工夫"，现在仓转的很标准，回想之前的转角，一会就差个5度10度，不然就疯狂抖动，现在心情舒畅了
3.转向后倒着走因为识别到了车底盘，同时之前的位置矫正如果坐标不刷新就会一直保持上一状态，导致可能走出赛道，现已改进

下一阶段就是不断测试，不断找潜在的bug,同时进行优化，提高稳定性与完赛速度，目前有以下几点：
0.首先把剩下的坡道和障碍物解决
1.用于分类的目标检测框照片可能还是稍有问题：可以考虑重新框，框得越准自然分类的正确率就会越高
2.加上错误修复，**提高整体的容错性**，比如即使在十字逻辑发生了错乱也不影响在环岛进行操作
3.之前的边界矫正稍微还有点问题，看看能优化进一步提高鲁棒性
4.去掉不必要的延时，在保证卡片识别正确率的基础上加快运行速度，看看能不能到**5min**以内
5.考虑在mcx端对目标直接进行过滤操作，因为有一定概率会误识别停下来，虽然不影响后面的执行，但挺费时间
6.代码优化：尽量把之前的参数声明在全局变量，把相同逻辑封装起来只需改变全局参数即可调参，而不用在相应代码段一个一个一次该让参数好改，易改，一目了然
7.结构优化：补光灯可以加上，仓换新版，框架的强度可以提升，前面支撑摄像头的碳杆得想办法限位，这个最好让他没有活动空间

**说长也长，说短也短，7月份就开始比赛了，6月又有不少考试，一个月过得是真的快，所以啊，后面不能松懈，提高执行力**

### 2024/6/23
最近刚考完电拖和数电，但愿能过吧，也是许久未更新了，搞得都不想更了，想着还是更新记录一下吧
已解决问题：
- 障碍物和坡道基本解决了
- 之前分类之前用于框图片的目标检测框不准的问题是由于，没有将原始图像压缩成正方形，逐飞在群里说明了这个问题
- 代码的容错性提高了一部分呢，但仍有许多可以去提升的
- 边界矫正就是之前y轴设置的目标值的问题，把它目标y值设小一点应该就行了
- 目前去掉了大部分延时，连续拣、放卡片以及模式切换都快了不少
- 加了补光灯，但是接触不良

下一阶段：
- 1 将电磁铁时而吸不起来的问题解决一下，最近调车，这问题太恶心了，C,不知道是线松了还是mos管坏了还有就是补光灯估计是线有点松动，之前仓抖动也是由于线松了，下一步可以全面排查把这类由于线松动接触不良的问题彻底解决
- 2 重调一下边界矫正，之前边界一直都不是很硬，而且目前都是大十字，小十字不知道行不行，此外环岛边界矫正的最大横向速度也是和这个直接挂钩的，争取把它调硬一点（考虑一下把前轮差速给大一点？）
- 3 今天在B站看了一个弯道贼极的赛道，我在想会不会误判，由此想到可以把之前的环岛/十字/障碍物检测优化一下，加强鲁棒性
- 4 还有就是检测三大类放置区，虽然目前感觉没啥问题，但我感觉还得优化，之前写的感觉太就简单了，而且也是可以将
- 5 之前的一个bug: 不知道是检测到了其他杂物还是其它什么原因，小车在转弯完成后会慢慢的移动，想不明白，之前我是针对这个问题改过的，在postion_correct里特意加了如果串口1没有识别道卡片（或者卡片距离没有小于目标值）就给小车速度赋值为0，但是现在它却在慢慢移动?是很缓慢的那种移动，？？？
- 6 接上一条，我感觉不一定是矫正这一部分出问题，在矫正之后可能也有问题，回头将这部分时序再排查一下
- 7 mcx目标检测目前对于字母“I”很容易识别不到，稍微换下角度就行了？要不要重新打标签，或者把mcx安装位置后移
- 8 目前测试的卡片就那固定的几类，后面换成其他没有测试过的类别再测测
- 9 对于有部分卡片识别结果会在几个字母之间跳变，这种是丹的问题吗？如果实在不能解决，可以写一下判断，直接放弃这张卡片，不至于一直卡在这
- 10 最后就是多跑，多测试了，后面可能反而能跑的时间不如现在多，趁现在多跑跑找bug吧



### 2024/7/7

！！！灵感爆发，突破性进展！！！
  今天也是又和兄弟们熬了一夜，果然晚上才是灵感爆发的时候，之前一直苦于有时候捡一次卡片捡不起来或者不小心没放下而需要捡第二次，但对于环岛和十字这种对卡片次序要求非常高的卡片堆无疑是巨大的灾难，几乎是只要是一次捡不起来多捡一次或者交换仓中卡片或放卡片出错后面的都会错，几乎每次跑一圈都会有这种问题，非常恶心人，从调车开始恶心到现在，之前一直考虑提高电磁铁和机械臂的角度，但问题没有得到很好的解决，如何知道有没有成功捡起或放下卡片也一直没有很好的解决方案，因为目前的结构确实没有可以检测的东西，但为什么不加一个呢？于是顺着这个想法感受到了极高的可行性，不就是加一个接近检测或者测距模块吗，于是我们采用了用于循迹小车的红外对射管，随便找了个之后测试非常可行遂熬夜一天给车车加了一块，调试后也是非常顺人心意，这一个小小的改动为我们解决了一个非常致命的问题，也不知道为什么以前没想到😞，今晚加油调，我有预感今晚会完美完赛😍😍😍
  
-电测铁有很大一部分原因是线虚的问题，刚才也是发现它断了，当然也有角度的问题，但随着我们可以知道是否捡到卡片，我们就可以知道卡片的数目而去自动调整角度，还可以无限次数的捡和放而不对记录的卡片次序产生影响，这个问题以后会得到很好的解决。
- 小车在转弯完成后会慢慢的移动的原因是当时写代码的逻辑问题，现在已经解决。


- 现在bug还是很多，但好在我们现在可以知道是否捡到卡片，大部分bug会得到解决。
- 将是否捡到卡片的判断加到捡和放卡片的逻辑中，包括捡卡片，放卡片和交换
- 试一试红外对射管的稳定性，据说会受日光影响
- 需要自己制作红外对射管，补光灯和转接板，并在铜层加队伍信息
- 弯道和s弯的卡片有时候会转错放下或者看不到
- 最后就是多跑，多测试了，时间剩的并不是很多，尤其是现在期末周有很多考试（明天考电机学，大后天考复变，还没复习呢😭😭😭），继续找bug解决bug。   加油！！！


-
今天早上也是试了试，光照对光电传感器影响还是挺大的，又是思考了半天如何解决这个问题，然后突然灵光乍现，为什么非要用电子传感器去完成这个功能呢，一个小小的微动开关也可以做到，而且抗干扰能力直接拉满😎😎😎😎

### 2024/7/27
现在是中午12点半，坐在回程的动车上，望着窗外一片青翠的景色，一动不动发了会呆，哈哈感叹恍然间省赛就这么结束了
感谢！省赛没出太大意外，还碰巧让我们拿了第一😁

回想两周前，从刚考完最后一门考试，感叹着时间紧，任务重，车的稳定性非常有待提高……感觉有些许焦虑，再到后面扣细节，把没有必要的延时去掉或缩短，把车车的转向过程优化，把各种能提高鲁棒性的判断加入，把新遇到的bug及时解决，虽通宵调车，却也收获颇丰。
21日，多亏了焦老师我们得以去大连民族大学测试车车的稳定性。不得不说去了现场发现他们实验室比我们实验室亮了很多，当时第一感觉是亮度对巡线和识别的影像应该不是不是那么大，然而当我给车模上电，把车车放在赛道上时，才发现mcx过曝非常严重，屏幕显示中心部分严重白化，对目标检测影响非常大。总钻风也因亮度的原因，巡线出了问题，斑马线也因此没识别到。说实话当时还是比较慌的，因为我在模拟这就是到时候真正比赛的赛道，如果到时候我们也遇到这问题能冷静应对吗。可能是我们从一开始就一直在自己的实验室调试，没有去其它场地调试过，因此一直以来我们的曝光度都没怎么改过。也正是这个原因，我们在当时没有第一时间反应过来去改曝光度。好在后面我们开了屏幕，又把总装风采集到的灰度值显示在屏幕上面，才发现了问题所在。后面在改了曝光时间后，我们在他们场地跑了几圈，感觉问题不是很大，于是下午就回去了。

回去已经将近晚上9点了，学校已关门，因此我们只能抱着车车回到租房的地方睡了一晚。第二天到了22号，也就是我们正式出发前的最后一天。早上起来9点多了，没办法，再把车车抱回实验室，开调！调到下午那会发现仓的转动出了问题，在交换卡片时，会由于仓转动角度不准，导致电磁铁吸附时端面没有与卡片平齐而吸不起来，以为舵机坏了，拆仓、代码调偏移角度。最后都感觉不是这些原因，后面把仓下面的线压平一点，似乎问题解决了，怀疑是下面的线和上面的仓之间的摩擦力太大了，导致最后仓不能转到指定角度；之前写了一个防止误捡字母卡片的判断，但是就很离谱：冲环岛一侧测试没问题，但从另一侧测试发现始终有问题，后来发现把速度降低就行了；后面强化训练环岛和十字部分，发现有一定概率，会把识别到的字母给晃掉。于是加了个蜂鸣器，才发现原来在反复进行判断，根本没有进入后面的循环，后面经过改正后，环岛十字的稳定性得到了极大提升。也可能正是由于改了这个，在后面art识别时，出现了一点问题，有些识别错误。后面想，应该是没有延时进行缓冲，于是在后面的判断中先加上延时1s在进行判断，就没有问题了！自此我感觉我们的车车稳定性应该是比较好的了，至少要比之前好不少。唯一遗憾的是在转向完成时会有停顿一会，没有之前的丝滑了，就很玄学，在去大连民族之前完全没有出现过这个问题，不过也还好，除了看着很难受，浪费了十多秒，对总体感觉影响不大。到这已是次日的4点，心想还可以再睡4个小时

24日，到了长春，上交车模。抽签比赛顺序，最后抽到了第二个上场。既是不幸也是万幸。不幸的是比赛顺序太靠前，可能没有太多准备与调试时间；万幸的是，当时我们第二个上场，由于裁判放卡片不小心放多了，之前计时时间不算，重新清零20分钟，相当于在初赛解了我们的燃眉之急。纵观初赛与决赛，发现大多数队伍在调试的时间上占用太长了：本来总共20分钟的比赛用时，可能调试都花了5～10分钟，我们队还好，在初赛把曝光度给调好之后，决赛上场前以及上场比赛时几乎没再调过参数，直接上场就发车，这里也得感谢赛前的大连民族之旅，给我们打了一剂强心针。这里额外提一下：我们的总装风会根据采集到的图像计算出参考的白色灰度值，但之前我们进行了优化，并不是完全根据采集是灰度计算白色参考灰度值，而是有一个基础白色灰度值（我记得应该是130），而且基础灰度值的占比为0.7，采集得来的灰度值占比为0.3。之前这样优化是为了避免采集图像拍摄的区域不在赛道上或者赛道上有部分黑影而影响整体计算出的白色参考灰度值。但这样做的弊端就是，没到一个新的场地，得重新调节一下曝光时间，使起采集得来的灰度值就在130左右。这样就相当于在基础灰度值的基础上加上一个全局动态灰度值，这样即可以考虑到同一赛道不同地方由于灯光影响导致的亮度不一样，也可以避免采集图像有问题而导致最终计算出的白色灰度值偏差的太离谱省赛就这样告一段落了，还有许多想要说的，这里就不一一列举了...

这里得感谢木哥旺哥博哥，在我们最后的备赛期间为申请实验室而四处联系，感谢一起调车时焦老师和张老师的陪伴，感谢山哥的帮助，感谢徐老师的精神陪伴与鼓励，感觉王老师的带队工作，感谢学社，感谢陈老师，感谢所有的兄弟们，咱们哈尔滨再见！


张老师和江老师辛苦😭，望诸位兄弟都能所得即所愿，哈尔滨书写新篇！



### 2024/8/23


  哈尔滨之旅圆满结束！！！一切都像做梦一样，这次也是拿到了梦寐以求的国一和凤凰佬的签名和合照，最最最最重要的是也又一次见到了徐老师😍。

  
  自省赛结束这段时间也是比较懈怠，也没多在智能车上浪费时间，回去之后马上就和江老师开始了电赛的任务，从出题开始四天三夜
也是比较抽象，前两天都在搭结构大螺丝，直到最后一天才稍微有点起色，连夜写完了大部分控制代码，也是非常极限，电赛从做到交作品演示大概花了五六天的时间，只能说非常折磨人，今年又是省赛年也不好玩，最后省二而归。整完就和江老师商量了车车的结构问题，因为各种原因，结构也没有大改，基本采用以前的结构，多加了几个补光灯，换了个大的电磁铁，但最后好像用处不是很大，赛场上的灯光太强，影子依然是有，观看其他学校的结构，我感觉我们的机械表似乎有点太结实，相比于那些晃晃的机械臂，这样反而不好，角度有一点不对就会吸不上来，这个问题也是从调车开始就一直恶心我们到现在，然后就是把仓下面挡住防止下面的线摩擦到仓。也有过想换五分类仓，但一是经费不足，二是又很浪费时间也快不了多少，要是加仓门的话主板又要改，最后就没有变动。改完结构的后面这段时间我也是没有怎么调车，和江老师这段时间也是比较轻松，比较懈怠。后面基本上都是江老师断断续续的调，我也是好久没看代码，从这里反省一下😁。

  
  我其实一直以来是比较求稳的，在车车没稳定之前我是不会去想让它去提升，省赛之后虽然跑的非常好，但感觉还是有很多问题，江老师一直都在追求速度，中间也是有很多意见的不同。不知道为什么，感觉不管是电赛还是智能车还是电赛，我们都做的很极限，智能车省赛，电赛都是比赛前一天才调好，这次依然一样😂，17号晚上，也就是要出发前的前一天，我们才开始让车车跑全场，最后当然是非常不好，这里再次反思一下，不该这么懈怠。然后就开始连夜调车，调的过程中又发现仓又转不准，然后就是拆了又装，装了又拆，幸好最后发现只是舵盘的螺丝没拧紧，然后就继续调车，接着就是各种奇怪的问题，舵机烧了连夜换舵机，又是拆了木哥去年的仓（这次木哥的国赛车车真的被我们完全拆干净了🥺），运动姿态不对，捡不上来，反正就是完赛不了，甚至我已经换上了省赛的代码，一直调，调到了第二天下午，最后才勉强完赛，这时候已经差不多都是省赛代码了，已经做好了国二万岁的准备匆匆出发。


  来到比赛的前一天，有一次调车的时间，一个队20分钟，我们和电子科技大学合起来拿到了40分钟的调车时间，调试的时候也是出了很多问题，光是起跑线的曝光度就调了十几分钟，最后跑整圈的时候还出现了因为仓里的卡片太多所以放的时候发不下的问题，结束后心情也是既忐忑又紧张，再酒店又调了一会，和江老师商量了下对策，决定先环岛十字都关保证完赛，后面再上优化的版本。有因为种种原因，视觉组改为只有一次比赛，不进行预赛决赛制，到了比赛的那天也是非常紧张，幸运的是，上场前车车得到了徐老师和旺哥的虔诚跪拜，上场比赛的时候一切都非常顺利，保证完赛的版本一遍就过，保证了国二，后来又上了快速的版本，也是一遍过，这里也多亏了江老师调的快速版本，不然真不一定能国一😘……





  
  回去路上徐老师让我们注意来时的风景和现在的风景，感觉一切都不一样了，轻松，欢快，对付出得到回报的欣慰，一切都是对这一学期艰难的最好慰藉。



  
  最后一定要感谢一下徐老师木哥对学弟的传承与教授，旺哥博哥为我们申请实验室的奔波和他们的陪伴（感谢旺哥送黑神话悟空，让我直面天命😍😍😍），学长们的陪伴与关心让我感受到了家的温暖，感谢焦老师江老师亦师亦友，感谢青哥和山哥的陪伴与帮助，在华发新城和兄弟们生活的这段日子难以忘怀，我也得到了很大的提升。感谢冯忠英师兄和李婷婷师姐的热情款待，真的没想到远在哈尔滨还有电子学社的家人款待陪伴我们，感谢陈老师，感谢电子学社。希望以后的学弟学妹们继续探索，再创新辉煌。





  虽然但是四级好像又挂了😊😊😊😊😊😊
  
  












  


### 2024/8/24
国赛结束，拿下国一🎉🎉🎉

省赛回来后，刚开始有想改五分类的想法，也想过借鉴他们的储物仓，要不要升级成可一次性卸卡片的储物仓，但后面碍于打印机坏了的窘境以及想摆烂的想法，于是最终决定就沿用之前的四分类，转为优化一些运行速度以及提高控制的稳定性

其实从一开始，我们的想法就是直接用一个四分类，让车壳的体积尽量小。卡片无非就分为散落卡片（最多3类）和圆环卡片（最多5类），因此仓的数量根据圆环最多卡片类别5类设置即可，可以说5分类是比较合理的的选择。四分类在圆环元素分拣卡片遇到有5类卡片时，我们选择把第五类重叠在第一类上，因此在放置卡片时我们有时会把其中一个仓的卡片先移到另一个仓，再将下面的卡片放置出去。

前段时间把实验室里不知道哪届学长的圣遗物一张弓拿来玩了玩，调车调累了就去实验室的另一头射射箭，哈哈。由于省赛之后几乎没怎么改结构，所以在调试时基本就是在原来的地方改了改，优化了一下，期间感觉比较枯燥，因此在去哈尔滨的前几天，我白天一半时间在调车，一半时间在射箭，难崩，可能正是这个原因后面来了报应😂。

先简单说说这期间优化的几点：1. 将车身转向与机械臂拾取卡片这两个同时进行，尽可能缩短了拾取时间。2. 微调了一下循迹的pid，让目标检测的视野更贴近在赛道中央，这样可以避免在一些s弯道因视野盲区而漏检卡片。3.加上了多级菜单调参，以备国赛决赛时不让下载代码的情形。4。将各种不必要的延时，以及不必要的时间浪费进行优化，在保证基本稳定的情况下，去掉不合理的操作

说来你可能不信，出发前的几小时我还在调车，哈哈只怪自己太憨了。出发前的最后一天，本想着调一下循迹的pid参数，调了一半，由于是共用赛道，模型组的焦老师准备调会儿。也罢，我便出来去实验另一边射箭。很久之后，玩累了，见见焦老师电池充电去了，那好，我也去调调吧。一调一个不对劲，后面发现小车循迹时很晃动，一开始以为是总装风的问题，因为之前发现总转风初始化的时候，在同一个位置，每次初始化得到的平均灰度值都会差很大。后面复位了几次，仍然不行，很是懊恼，又是加上屏幕显示灰度值，又是查看图像处理的边线，感觉都没问题。十分懊恼。调到后半夜，祸不单行，机械臂小臂的舵机坏了，不能复位，只好再一次打螺丝，更换了新的舵机。又开始重新调了机械臂的角度，都快出发了，还更换机械谁能懂。又是一个通宵调车，越调越烂，累，身心俱疲。后面想了一下，要完赛都完赛不了那我调鸡毛啊。把之前的代码烧进去试了试，似乎比目前的版本好了些。于是乎，对照了之前的代码才发现之前随便的改的循迹pid参数没有复位，kd本是15，之前改成1.5试试效果，后面去射箭，忘改回来了，joker🤡！ 改完之后，感觉还行，想着先跑一圈完赛看看，后面发现放三大类时又有了问题：放完一个位置时，后面的两类，车车大概率不识别直接走了，离谱。这种问题，之前可从没有过，后面试了多次，也检查了多次，也是没找出问题所在。后面张老师把openart识别的脚本改了回去，似乎放置又可以了。这期间由于各种问题的集中出现，我把之前比较快的版本几乎又改回省赛时的了。这时感叹，半个多月改了个寂寞，唉！不甘心，那又怎样呢，先保证完赛吧，保住之前的成果。下午6点多的火车，准备4点多出发，最后我也几乎调到了3点，最后回去洗了个澡，怀着忐忑的心情就这样出发了。这倒是和省赛前的最后一天挺像，哈哈，每次赛前都得搞一波心态

到了哈尔滨，找到了宾馆，赛事方安排第一天进行调试，在曝光上调了调，斑马线环岛十字这些都测了测，最后在放三大类的时候有一类由于卡片实在太多，电磁铁无法与卡片贴合，导致放不出卡片，不过还好，这个卡片时是我们当时随便放的，比赛时某一类肯定不会放这么多。第二天，由于群友们的各种争论，卓大决定视觉组只有一次决赛，没有预赛，由于我们靠后，比赛时间安排在了后一天。当天晚上想了下对策，先把环岛十字注释掉，跑一个有效成绩，然后想了想又把之前快的那一版改到了目前版本里，同时又备份了改之前的最后一版。这样就相当于有了三个版本。第二天一早六点半就起来了，抱着车车到了哈工程，8点多开测，很顺利，一次发车有了成绩，国二有了，于是乎第二次就赌了一把，直接用了前一晚在酒店改的代码，也很顺利，也完赛了，不过有两个卡片识别出了问题，罚时60s，最终成绩300s出头，后面接着又发了几次车，不过最终成绩都在300s左右，就这样比赛顺利结束。感谢徐老师在赛前为我们车车虔诚地磕了几个头，我哭死😭。国赛也算是有惊无险，拿下国一。

赛后，冯学长和李师姐分别请我们吃了两顿大餐，我们接着去了中央大街，去了江边...wan玩的很开心。比较遗憾的是未能求得卓大的签名与合照，不过这也无伤大雅。第二天，我们坐着卧铺回到了大连，归程很是感慨，尽在不言中

致谢：非常感谢冯学长和李师姐的热情招待，让我们品味了哈尔滨的美食，心情很舒畅😄。大二的智能车生涯也算是圆满结束了。非常感谢徐老师的到来，非常感动，徐老师还能来到国赛现场，陪伴我们，感谢遇见徐老师，留下了很多珍贵的回忆；再一次向旺哥，木哥，博哥表示感谢，前期为我们暑假申请实验室做了很多工作，幸苦哥们了；感谢张老师、焦老师在一起调车时的陪伴；感谢山哥和青青的帮助；感谢所遇到智能车友们；感谢电子学社这个大家庭，感谢陈老师；感谢智能车竞赛，让我一路上学会了很多东西；感谢一直陪伴我们的车车，辛苦了😁

前方的路还很远，我们仍将秉持智能车披荆斩棘的精神继续前行，臻图不止，征途不止。祝各位车友都能得其所愿，再见

